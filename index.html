<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Work Flow</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:white;
}

/* GLASS */
.glass{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(18px);
  border:1px solid rgba(255,255,255,0.15);
  box-shadow:0 8px 32px rgba(0,0,0,0.4);
}

/* NAVBAR */
nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px 40px;
  position:sticky;
  top:0;
  z-index:10;
}
nav h1{margin:0;font-size:18px}

.nav-kpis{
  display:flex;
  gap:40px;
}
.kpi{text-align:center}
.kpi span{display:block;font-size:11px;opacity:.6}
.kpi b{font-size:18px}

/* FILTER */
.filter-popup{
  position:absolute;
  top:70px;
  right:40px;
  width:260px;
  padding:15px;
  border-radius:16px;
  display:none;
}
.filter-popup input{
  width:100%;
  margin-bottom:8px;
  padding:6px;
  border-radius:8px;
  border:none;
  background:rgba(255,255,255,.15);
  color:white;
}

.container{
  max-width:1600px;
  margin:auto;
  padding:30px;
}

/* ADD SECTION */
.card{
  padding:20px;
  border-radius:20px;
  margin-bottom:30px;
}
.form-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
}
input{
  padding:8px;
  border-radius:10px;
  border:none;
  background:rgba(255,255,255,.15);
  color:white;
}
button{
  background:#00c6ff;
  border:none;
  padding:8px 16px;
  border-radius:20px;
  cursor:pointer;
}

/* TILE GRID */
.tile-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,300px));
  gap:25px;
}

.tile{
  padding:18px;
  border-radius:20px;
  transition:.3s ease;
  cursor:pointer;
}
.tile:hover{transform:translateY(-5px)}

.tile h3{margin:0;font-size:14px}
.small{font-size:11px;opacity:.7;margin-top:4px}

.status{
  display:inline-block;
  padding:3px 8px;
  font-size:9px;
  border-radius:12px;
  margin-top:6px;
}
.received{background:#888}
.selection{background:#2ecc71}
.quotation{background:#3498db}

.details{
  margin-top:10px;
  display:none;
  font-size:11px;
}
.tile.expanded .details{display:block}
</style>
</head>

<body>

<nav class="glass">
  <h1>My Work Flow</h1>

  <div class="nav-kpis" id="navKpis"></div>

  <div>
    <span style="cursor:pointer" onclick="toggleFilter()">üîç</span>
  </div>

  <div class="filter-popup glass" id="filterPopup">
    <input type="text" id="filterProject" placeholder="Project name">
    <input type="text" id="filterCustomer" placeholder="Customer name">
    <input type="date" id="filterReceivedFrom">
    <input type="date" id="filterReceivedTo">
    <input type="date" id="filterSentFrom">
    <input type="date" id="filterSentTo">
  </div>
</nav>

<div class="container">

<div class="card glass">
  <div class="form-grid">
    <input id="project" placeholder="Project Name">
    <input id="customer" placeholder="Customer Name">
    <input type="date" id="received">
    <button id="addBtn">Add</button>
  </div>
</div>

<div class="tile-grid" id="tileGrid"></div>

</div>

<script>
const $=id=>document.getElementById(id);
let projects=JSON.parse(localStorage.getItem('hvacProjects'))||[];

function toggleFilter(){
  const popup=$('filterPopup');
  popup.style.display=popup.style.display==='block'?'none':'block';
}

['filterProject','filterCustomer','filterReceivedFrom',
 'filterReceivedTo','filterSentFrom','filterSentTo']
.forEach(id=>$(id).addEventListener('input',render));

$('addBtn').onclick=()=>{
  const p=$('project').value.trim();
  const c=$('customer').value.trim();
  const r=$('received').value;
  if(!p||!c||!r)return;

  projects.push({
    id:Date.now(),
    project:p,
    customer:c,
    received:r,
    sent:'',
    status:'received',
    remarks:''
  });

  localStorage.setItem('hvacProjects',JSON.stringify(projects));
  render();
};

function render(){

  const rec=projects.length;
  const sel=projects.filter(x=>x.status==='selection').length;
  const quo=projects.filter(x=>x.status==='quotation').length;

  $('navKpis').innerHTML=`
    <div class="kpi"><span>Received</span><b>${rec}</b></div>
    <div class="kpi"><span>Selection</span><b>${sel}</b></div>
    <div class="kpi"><span>Quotation</span><b>${quo}</b></div>
  `;

  let filtered=[...projects];

  const fp=$('filterProject').value.toLowerCase();
  const fc=$('filterCustomer').value.toLowerCase();
  const rf=$('filterReceivedFrom').value;
  const rt=$('filterReceivedTo').value;
  const sf=$('filterSentFrom').value;
  const st=$('filterSentTo').value;

  if(fp) filtered=filtered.filter(x=>x.project.toLowerCase().includes(fp));
  if(fc) filtered=filtered.filter(x=>x.customer.toLowerCase().includes(fc));
  if(rf) filtered=filtered.filter(x=>x.received>=rf);
  if(rt) filtered=filtered.filter(x=>x.received<=rt);
  if(sf) filtered=filtered.filter(x=>x.sent && x.sent>=sf);
  if(st) filtered=filtered.filter(x=>x.sent && x.sent<=st);

  filtered.sort((a,b)=>new Date(b.received)-new Date(a.received));

  $('tileGrid').innerHTML='';

  filtered.forEach(x=>{
    const tile=document.createElement('div');
    tile.className='tile glass';

    tile.innerHTML=`
      <h3 onclick="this.closest('.tile').classList.toggle('expanded')">${x.project}</h3>
      <div class="small">${x.customer}</div>
      <div class="small">Received: ${x.received}</div>
      <div class="small">Sent: ${x.sent||'-'}</div>
      <span class="status ${x.status}">${x.status.toUpperCase()}</span>

      <div class="details">
        <label>Sent Date</label>
        <input type="date" value="${x.sent||''}" onchange="update(${x.id},'sent',this.value)">
        <div style="margin-top:6px">
          <label><input type="radio" name="status${x.id}" ${x.status==='selection'?'checked':''}
            onchange="update(${x.id},'status','selection')"> Selection</label>
          <label><input type="radio" name="status${x.id}" ${x.status==='quotation'?'checked':''}
            onchange="update(${x.id},'status','quotation')"> Quotation</label>
        </div>
        <textarea style="margin-top:6px;width:100%;border-radius:6px"
          onchange="update(${x.id},'remarks',this.value)">${x.remarks||''}</textarea>
        <div style="margin-top:6px;color:red;cursor:pointer"
          onclick="deleteProject(${x.id})">Delete</div>
      </div>
    `;

    $('tileGrid').appendChild(tile);
  });
}

function update(id,key,value){
  const p=projects.find(x=>x.id===id);
  p[key]=value;
  localStorage.setItem('hvacProjects',JSON.stringify(projects));
  render();
}

function deleteProject(id){
  projects=projects.filter(x=>x.id!==id);
  localStorage.setItem('hvacProjects',JSON.stringify(projects));
  render();
}

render();
</script>

</body>
</html>
